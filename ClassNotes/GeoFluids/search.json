[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Geophysical and Astrophysical Fluids",
    "section": "",
    "text": "Preface"
  },
  {
    "objectID": "index.html#module-overview",
    "href": "index.html#module-overview",
    "title": "Geophysical and Astrophysical Fluids",
    "section": "Module overview",
    "text": "Module overview\nWelcome to Geophysical and Astrophysical Fluids IV.\nThis module builds on Fluid Mechanics III to introduce the concepts required for understanding the flows that are common in geophysical and astrophysical systems such as the Earth and the Sun.\nIn Michaelmas, our aim is to derive and understand equations that govern many geophysical flows. We build on the concepts explored in Fluid Mechanics III to introduce the different types of dynamics encountered when rotation and/or stratification are present. We will derive mathematical descriptions and explore the rich landscape of waves and instabilities that can occur in these systems making connections between the mathematics and observed phenomena in planetary atmospheres and oceans along the way.\nIn Epiphany, we will extend the continuum model of liquids and gases from Fluid Mechanics III to encompass plasmas, through the theory of magnetohydrodynamics (MHD). Because plasmas are ionised gases that conduct electricity, there are now two primary variables: the velocity field and the magnetic field. Their coupling leads not only to important physical effects (such as solar eruptions, planetary magnetospheres, or the failure of fusion reactors) but also to elegant mathematical properties, for whose discovery Hannes Alfvén was awarded a Nobel prize in 1970."
  },
  {
    "objectID": "index.html#lecture-notes",
    "href": "index.html#lecture-notes",
    "title": "Geophysical and Astrophysical Fluids",
    "section": "Lecture notes",
    "text": "Lecture notes\n\nWe will generally follow these notes in the lectures, although not word for word. If you do spot any significant discrepancies, then please let us know! You should also be keeping up to date with the associated problem sheets, found on Learn Ultra.\n\n\n\n\n\n\nIn these notes, remarks in boxes like this provide extra information.\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nThese boxes highlight “examples”.\n\n\n\n\n\n\n\n\nImportant Equation Set\n\n\n\nBoxes like this one are used to highlight important equation sets.\n\n\nBelow is a table summarising the notation used throughout these notes. The list is not exhaustive.\n\nNotation\n\n\n\n\n\n\nSymbol\nMeaning\n\n\n\n\n\\(\\ub=(u,v,w)\\)\n3D fluid velocity and components (in Cartesian coordinates)\n\n\n\\(\\vb=(u,v)\\)\n2D fluid velocity and components (in Cartesian coordinates)\n\n\n\\(\\nabla = (\\cfrac{\\partial}{\\partial x},\\cfrac{\\partial}{\\partial y},\\cfrac{\\partial}{\\partial z})\\)\n3D gradient (in Cartesian coordinates)\n\n\n\\(\\nabla_H = (\\cfrac{\\partial}{\\partial x},\\cfrac{\\partial}{\\partial y})\\)\n2D gradient (in Cartesian coordinates)\n\n\n\\(\\Delta = \\cfrac{\\partial^2}{\\partial x^2}+\\cfrac{\\partial^2}{\\partial y^2}+\\cfrac{\\partial^2}{\\partial z^2}\\)\nLaplacian (in Cartesian coordinates)\n\n\n\\(\\rho\\)\nFluid density\n\n\n\\(\\nu\\)\nKinematic viscosity\n\n\n\\(p\\)\nPressure\n\n\n\\(b\\)\nBuoyancy\n\n\n\\(T\\)\nTemperature\n\n\n\\(\\fb_b\\)\nBody force\n\n\n\\(N(z)\\)\nBuoyancy (Brunt–Väisälä) frequency\n\n\n\nThese notes have been created with Quarto (https://quarto.org/docs/books)."
  },
  {
    "objectID": "intro.html#overview",
    "href": "intro.html#overview",
    "title": "1  Introduction",
    "section": "1.1 Overview",
    "text": "1.1 Overview\nGeophysical fluids, namely air in the atmosphere and water in the ocean, strongly influence life as we know it on planet Earth. Their dynamics shape the weather and the ocean circulations that affect our lives on a daily basis. For example, the daily weather forecasts that we check regularly are basically numerical solutions of dynamical equations for geophysical fluids. Furthermore, climate change is another important aspect relevant to geophysical fluid dynamics. The goal of this course is to study geophysical fluids and their motion from a mathematical point of view.\nFrom Fluid Mechanics III, you will be familiar with the Navier-Stokes equations. Atmospheric and oceanic flows are described by similar equations, but there are two distinguishing features of these flows that are not covered in details in generic fluids courses. The first feature is the variation of density in different layers of the atmosphere and ocean, known as stratification. We cover this phenomenon and some of its implications in Chapter 2. The other feature is the effect of the Earth’s rotation. We are observing the atmospheric and oceanic flows from a rotating frame of reference, which has important implications on their dynamics. In fact, the Earth’s rotation is one of the main drivers behind the weather systems and ocean circulation. We introduce rotating fluids and some of their features in Chapter 4 .\nGeophysical flows are also an amazing platform for the application of mathematics. Due to their complexity, we use a variety of mathematical tools to systematically simplify their governing equations. These simplifications are performed for specific scales or regimes of these fluids. In other words, the simplification and the type of mathematical tools that we employ are problem-dependent. In Chapters 3, 5, 6 and 7  , we will use different mathematical tools such as non-dimensionalisation and scaling analysis, perturbation techniques, linearisation and stability analysis in order to study problems of geophysical interest. Hopefully this will equip you with a set of applied maths skills that you can use in other contexts and problems. In the rest of this chapter, we review some generic aspects of fluid dynamics that you should be familiar with from Fluid Mechanics III."
  },
  {
    "objectID": "intro.html#review-of-governing-equations",
    "href": "intro.html#review-of-governing-equations",
    "title": "1  Introduction",
    "section": "1.2 Review of governing equations",
    "text": "1.2 Review of governing equations\nRecall from Fluid Mechanics III, the governing equations for a viscous and compressible fluid are the Navier-Stokes equations: \\[\n\\frac{\\partial\\rho}{\\partial t} + \\nabla\\cdot(\\rho\\ub) = \\frac{D\\rho}{Dt} + \\rho\\nabla\\cdot\\ub =0,\n\\tag{1.1}\\] \\[\n\\frac{\\partial\\ub}{\\partial t} + (\\ub\\cdot\\nabla)\\ub = \\fb_b -\\frac{1}{\\rho}\\nabla p+\\frac{\\nu}{3}\\nabla(\\nabla\\cdot\\ub) + \\nu\\Delta\\ub, \\tag{1.2}\\] \\[+ \\quad \\text{equation of state} \\tag{1.3}\\]\nwhere \\(\\rho\\) is the fluid density, \\(\\ub=(u,v,w)\\) is the velocity, \\(p\\) the pressure, \\(\\nu\\) the kinematic viscosity and \\(\\fb_{b}\\) represents body forces acting on the fluid (e.g., gravity). The operator \\[\n    \\frac{D}{Dt} = \\frac{\\partial }{\\partial t} +\\ub \\cdot \\nabla\n\\] is the material derivative. Equation 1.1 is a result of mass conservation and Equation 1.2 follows from momentum conservation. These four equations (remember \\(\\ub\\) has three components) provide dynamic relations between \\(\\rho\\), \\(\\ub\\) and \\(p\\) (5 unknowns). Hence, an equation of state is required to close the system.\n\n1.2.1 Equation of state\nThe equation of state provides a relationship between the pressure and density that is valid even when the fluid is at rest. This relation will often also depend on the temperature, \\(T\\), i.e., \\(p=p(\\rho,T)\\). In this case, \\(T\\) must be prescribed otherwise we would require a further governing equation for \\(T\\) (which is usually provided by conservation of energy but the details are beyond the scope of this course).\nA commonly used equation of state is the ideal gas law \\(p=\\rho \\mathcal{R}T\\) where \\(\\mathcal{R}\\) is a gas constant (which takes a different value for different gases).\n\n\n\n\n\n\nExample\n\n\n\nAir is considered to satisfy the ideal gas law with \\(\\mathcal{R}=287\\mathrm{Jkg^{-1}K^{-1}}\\) (for dry air).\n\n\n\n\n1.2.2 Incompressible fluids\nFor the incompressible flow we assume that the density of fluid parcels remains constant in time, i.e., \\[ \\frac{D\\rho}{Dt}  = \\frac{\\partial \\rho}{\\partial t} + (\\ub\\cdot\\nabla)\\rho= 0.  \\tag{1.4}\\] In other words, the rate of change of \\(\\rho\\) when following a fluid element is zero but \\(\\rho\\) is not necessarily constant. In this case, Equation 1.1 reduces to \\(\\nabla\\cdot\\ub = 0\\) and the governing equations for incompressible flow are \\[      \\frac{\\partial \\rho}{\\partial t} + (\\ub\\cdot\\nabla)\\rho = 0  \\tag{1.5}\\] \\[ \\nabla\\cdot\\ub = 0,  \\tag{1.6}\\] \\[ \\frac{\\partial\\ub}{\\partial t} + (\\ub\\cdot\\nabla)\\ub = \\fb_b -\\frac{1}{\\rho}\\nabla p + \\nu\\Delta\\ub.  \\tag{1.7}\\] Note, we have discarded the equation of state as it is redundant for incompressible flow.\n\n\n\n\n\n\nIn this course we will be largely concerned with stably stratified fluids where density is not constant and instead it changes with height/depth. However, we can remove a base profile of density and pressure and after a systematic simplification we find \\(\\nabla\\cdot\\ub = 0\\) for this system. This simplification is known as Boussinesq approximation, which we will study in Chapter 2.\n\n\n\n\n\n1.2.3 Inviscid fluids\nIn reality, both air and water are viscous (water is more viscous than air). However, viscosity acts at very small scales. For example, for atmospheric motion, the scale at which viscosity becomes very important (known as the Kolmogorov microscale) ranges from 0.1 to 10\\(\\mathrm{mm}\\). One may argue that at scales slightly above 10\\(\\mathrm{mm}\\) the effect of viscosity might still be felt. However, it is very reasonable to say that for the scales larger than kilometers the effect of viscosity on the dynamics is negligible. For the most parts of this course, we consider the large-scale motion in the atmosphere and ocean – scales of tens of thousand to hundred kilometers. Hence, we safely assume the flow to be inviscid, meaning we set \\(\\nu\\Delta\\ub \\approx 0\\) in equations (1.2) and (1.7).\nThat being said, viscosity is still an important part of geophysical fluids. Its effect is felt close to the boundaries (near the shores, the bottom of the ocean, or at the ocean surface). Microphysics is another area of geophysical fluids that is highly affected by viscosity (for example in the formation of clouds or disintegration of pollutants) but these are beyond the scope of this course.\n\n\n1.2.4 Initial and boundary conditions\nFrom the point of view of PDE analysis, the set of Navier Stokes equations (compressible or incompressible) need a set of initial conditions and boundary conditions to have a (unique) solution.\n\n\n\n\n\n\nEven with provided boundary and initial conditions (in the most general case), we are not sure if the Navier-Stokes equations have a unique solution. This problem (the regularity of Navier-Stokes equations) is one of the unsolved millennium maths problems with the prize of one million dollars. There are only seven millennium problems and one of them so far has been solved.\n\n\n\nCommon boundary conditions which may be used are: 1) no-slip condition for viscous fluids in which the velocity is zero or a given value at boundary, and 2) free-slip for inviscid flow in which the velocity normal to the boundary is zero. There are other types of boundary conditions such as fixed values of velocity at the flow inlet or zero-shear at free surfaces.\n\n\n\n\n\n\nThe governing equations are hard to solve, even numerically! Our approach is to make simplifications. You see different ways of simplifying these equations in different parts of the course. These simplifications in geophysical fluid dynamics are referred to as reduced models as they reduce the complexity of original systems."
  },
  {
    "objectID": "intro.html#sec-hydrostat",
    "href": "intro.html#sec-hydrostat",
    "title": "1  Introduction",
    "section": "1.3 Hydrostatic balance",
    "text": "1.3 Hydrostatic balance\nFor simplicity, consider a time-independent state of the inviscid, compressible system with no flow (\\(\\ub = 0\\)). Assume that gravity acts on the fluid so that \\(\\fb_b=-g\\eb_z\\) (we assume gravity acts downwards and \\(z\\) points upwards). Note, Equation 1.1 is trivially satisfied for \\(\\ub=0\\) and \\(\\frac{\\partial}{\\partial t}=0\\). In order to satisfy the horizontal components of Equation 1.2 we must have \\[\n0 = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}, \\quad 0 = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y},\n\\] and therefore \\(p\\) is a function of \\(z\\) only. The vertical component of Equation 1.2 gives that \\[ \\frac{\\partial p}{\\partial z} = -\\rho g.  \\tag{1.8}\\] Since the left-hand-side of Equation 1.8 is just a function of \\(z\\), so must the right-hand-side be, and hence \\(\\rho\\) also only depends on \\(z\\). Equation 1.8 is called hydrostatic balance and is an important concept that will be used throughout this course. From this equation, we see that pressure decreases with height. Specifically, if we integrate from an arbitrary height/depth \\(z\\) upwards/downward to a reference level \\(z=z_0\\) (e.g., ocean surface or ground) then we find \\[\\begin{equation}\np_t-p(z) = -\\int_z^{z_0} \\rho g \\,dz \\quad \\Rightarrow\\quad p(z) = p_0 + \\int_z^{z_0} \\rho g \\,dz.\n\\end{equation}\\] This says that the pressure at any level is equal to the pressure at the reference level \\(p_0\\) plus the total weight (per unit area) of the fluid column above that level.\nNote an equation of state \\(p=p(\\rho,T)\\) implies that if \\(p\\) and \\(\\rho\\) are only functions of \\(z\\) then so is the temperature \\(T\\). In cases where \\(T\\) is prescribed, the equation of state can in theory be combined with Equation 1.8 to obtain \\(\\rho\\) and \\(p\\) as functions of \\(z\\).\n\n\n\n\n\n\nExample\n\n\n\nConsider an ideal gas atmosphere with a constant temperature \\(T\\) occupying \\(z&gt;0\\). By combining the ideal gas law, \\(\\rho=\\rho\\mathcal{R}T\\) with the equation for hydrostatic balance (Equation 1.8), we can determine \\(\\rho\\) and \\(p\\) (given that \\(T\\) is constant).\nFrom the ideal gas law we have that \\(\\rho=\\frac{p}{\\mathcal{R} T}\\) and therefore, from Equation 1.8, we have \\[\n\\frac{dp}{dz} = -\\frac{gp}{\\mathcal{R} T}=-\\frac{p}{H},\n\\tag{1.9}\\] where \\(H=\\frac{\\mathcal{R}T}{g}\\) is a scale height. Solving Equation 1.9 for \\(p\\) gives \\(p=p_0e^{-\\frac{z}{H}}\\) where \\(p_0=p(z=0)\\) is the pressure at the bottom of the atmosphere. It follows that \\(\\rho=\\frac{\\rho_0}{\\mathcal{R} T}e^{-\\frac{z}{H}}\\).\nTherefore, we see that both \\(\\rho\\) and \\(p\\) decrease upwards with a scale height of \\(H\\). A scale height is typically defined as a distance over which a quantity changes by a factor of \\(e\\).\nFor the Earth’s atmosphere, taking \\(T=270\\mathrm{K}\\) and \\(\\mathcal{R}=287\\mathrm{Jkg^{-1}K^{-1}}\\) gives \\(H\\approx 8\\mathrm{km}\\).\n\n\n\n\n\n\n\n\nExample\n\n\n\nConsider an ocean of constant temperature \\(T\\) and depth \\(D\\) occupying \\(-D&lt;z&lt;0\\). In this case, we use an equation of state more appropriate for water: \\[\\begin{equation}\n\\rho=\\bar\\rho(1-\\alpha_T(T-273) + \\alpha_p p)\n\\end{equation}\\] where \\(\\alpha_T&gt;0\\) is the coefficient of thermal expansion and \\(\\alpha_p&gt;0\\) is the coefficient of compression. Estimates for sea-water give \\(\\bar\\rho=1028\\mathrm{kgm^{-3}}\\), \\(\\alpha_T=1.7\\times10^{-4}\\mathrm{K^{-1}}\\) and \\(\\alpha_p=4.4\\times10^{-10}\\mathrm{Pa^{-1}}\\).\nCombining this equation of state with the equation for hydrostatic balance (Equation 1.8) gives \\[\\begin{align}\n\\frac{1}{\\alpha_p\\bar\\rho}\\frac{d\\rho}{dz}&=-\\rho g\\\\\n\\Rightarrow \\frac{d\\rho}{dz} &= -\\alpha_p\\bar\\rho\\rho g = -\\frac{\\rho}{H},\n\\end{align}\\] where \\(H=\\frac{1}{g\\alpha_p\\bar\\rho}\\) is a scale depth. Hence, \\(\\rho=\\rho_0e^{-\\frac{z}{H}}\\) where \\(\\rho_0=\\rho(z=0)\\) is the density at the top of the ocean. So the density increases downwards with a scale depth of \\(H\\).\nFor the Earth’s ocean, using the values above for \\(\\alpha_p\\) and \\(\\bar\\rho\\), we find \\(H\\approx 220\\mathrm{km}\\). Therefore, over an ocean depth of \\(5\\mathrm{km}\\), the density increases by a factor of \\(e^{\\frac{D}{H}}=e^{\\frac{5}{220}}\\approx 1.023\\), i.e., an increase over only a few percent."
  },
  {
    "objectID": "strat.html#buoyancy",
    "href": "strat.html#buoyancy",
    "title": "2  Stratification",
    "section": "2.1 Buoyancy",
    "text": "2.1 Buoyancy\nA heavy object sinks down in a fluid because of gravity, but lighter objects float because of an upward force that the fluid exerts on them opposite to the direction of gravity. This force – known as buoyancy – is due to the weight of displaced fluid.\nTypically, fluids in the atmosphere and ocean are stratified. That is, the density of air in the atmosphere and of water in the ocean varies with height. In a stably stratified medium (where lower density layers are above higher density ones), when a fluid parcel is pushed down vertically, we expect that it will try to come back up due to buoyancy force, and vice-versa. By considering the motion of such a fluid parcel, we can infer its buoyancy which is an important property of stratified fluids.\n\n\n\nFigure 2.1: A fluid parcel is raised from height \\(z^*\\) to height \\(z^* + \\Delta z\\) in a layer of hydrostatically balanced fluid.\n\n\nConsider a fluid at rest with density \\(\\tilde\\rho(z)\\) and hydrostatic pressure \\(\\tilde p\\), i.e., \\(d\\tilde p/dz = -g \\tilde\\rho\\). Then consider raising a parcel of fluid from a height \\(z^*\\) to \\(z^* + \\Delta z\\) (see Figure 2.1). At \\(z^*\\), the environment and the parcel are in hydrostatic balance and so \\[\n\\frac{d\\tilde p}{dz}\\bigg |_{z^*} = -g \\tilde\\rho(z^*) = -g \\rho_p(z^*),\n\\] where we denote by a subscript \\(p\\) a variable following the parcel and a tilde denotes an environment variable.\nThe environment at \\(z^*+\\Delta z\\) is also in hydrostatic balance: \\[\n\\frac{d\\tilde p}{dz}\\bigg |_{z^*+\\Delta z} = -g \\tilde\\rho(z^* +\\Delta z).\n\\]\nHowever, the fluid parcel at \\(z^*+\\Delta z\\) is now being acted on by a force given by \\[\n-\\frac{d\\tilde p}{dz}\\bigg |_{z^*+\\Delta z}  -g \\rho_p(z^* +\\Delta z)\n\\] since the pressure of the parcel is the same as the pressure of the environment. Note the pressure gradient acts upwards and gravity downwards. Then, since \\(-g \\rho_p(z^* +\\Delta z) \\neq -g\\tilde\\rho(z^* +\\Delta z) = {d\\tilde p}/{dz}\\bigg |_{z^*+\\Delta z}\\), there is a net force acting on the fluid parcel (per unit volume) which can be written as \\[\n    F_b = g \\tilde\\rho(z^* +\\Delta z) - g \\rho_p( z^* +\\Delta z)\n\\tag{2.1}\\]\nWe can then apply Newton’s Second Law to the parcel at \\(z^*+\\Delta z\\) to give \\[\n    \\rho_p(z^* +\\Delta z) \\frac{d^2 \\Delta z}{dt^2} = F_b\n\\] and so \\[\n\\frac{d^2 \\Delta z}{dt^2}  = \\frac{g\\left[ \\tilde \\rho(z^* +\\Delta z) -  \\rho_p( z^* +\\Delta z) \\right]}{\\rho_p(z^* +\\Delta z) }.\n\\tag{2.2}\\] Next, if we assume the density of the parcel is conserved then we have that \\(\\rho_p(z^* +\\Delta z)=\\rho_p(z^*)=\\tilde\\rho(z^*)\\). Then we can write Equation 2.2 as \\[\n\\frac{d^2 \\Delta z}{dt^2}  = \\frac{g\\left[ \\tilde \\rho(z^* +\\Delta z) -  \\tilde\\rho( z^*) \\right]}{\\tilde\\rho(z^*) }\\] \\[ \\approx\\frac{g}{\\tilde\\rho(z^*)}\\frac{d\\tilde\\rho}{dz}\\bigg |_{z^*}\\Delta z  \\tag{2.3}\\] where we have used a Taylor series for \\(\\tilde\\rho(z^* +\\Delta z)\\) to arrive at the final expression. We see that if \\({d\\tilde\\rho}/{dz}&lt;0\\) then solutions to Equation 2.3 are oscillatory with frequency \\(N(z^*)\\) where in general \\[\nN^2(z) = -\\frac{g}{\\tilde\\rho}\\frac{d\\tilde\\rho}{dz}.\n\\tag{2.4}\\] The quantity \\(N(z)\\) is known as the buoyancy frequency or Brunt–Väisälä frequency. It gives the theoretical frequency of vertical oscillations of a small parcel of fluid in a stratified medium.\n\n\n\n\n\n\nExample\n\n\n\nConsider a fluid parcel that is raised a distance \\(\\Delta z_0\\) in a fluid that is at rest. Find the motion of this parcel after it is let go.\nWe assume that the displacement is small such that \\(N = N_0\\) remains constant. To find the parcel dynamics we then need to solve \\[\n    \\frac{d^2 \\Delta z}{dt^2}  = - N_0^2 \\Delta z, \\quad \\Delta z (t=0) = \\Delta z_0, \\quad \\frac{d \\Delta z}{dt}  (t=0) = 0.\n\\tag{2.5}\\] The solution to this equation is \\[\n    \\Delta z(t) = \\Delta z_0 \\cos{(N_0 t)},\n\\] which is a simple oscillatory motion with frequency \\(N_0\\). Equation 2.5 is very similar to the linear pendulum equations. In pendulum motion, the restoring force is gravity, whereas here the restoring force is buoyancy.\n\n\n\n\n\n\n\n\nIf \\({d\\tilde\\rho}/{dz}&gt;0\\) then \\(N^2&lt;0\\) and the stratification is unstable meaning that if we raise a fluid parcel it will continue to rise.\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nFor a constant temperature atmosphere, we saw in an earlier example that \\(\\tilde\\rho = \\rho_se^{-\\frac{z}{H}}\\) where \\(\\rho_s = \\frac{\\rho_0}{\\mathcal{R}T}\\) and \\(H=\\frac{\\mathcal{R}T}{g}\\). For this stratification, \\[ N^2 = -\\frac{g}{\\rho_se^{-\\frac{z}{H}}}\\left( -\\frac{\\rho_s}{H}e^{-\\frac{z}{H}}\\right) = \\frac{g}{H}=\\frac{g^2}{\\mathcal{R}T}.\\] That is, \\(N\\) is independent of \\(z\\). With \\(T=300K\\), \\(N\\approx 0.03s^{-1}\\). Observations tell us that a more realistic value for \\(N\\) is approximately \\(0.01\\mathrm{s^{-1}}\\)."
  },
  {
    "objectID": "strat.html#boussinesq-equations",
    "href": "strat.html#boussinesq-equations",
    "title": "2  Stratification",
    "section": "2.2 Boussinesq equations",
    "text": "2.2 Boussinesq equations\n\n2.2.1 Density and temperature variation in the ocean and atmosphere\n\n\n\nFigure 2.2: (a) Position of different measurements in the Canada Basin of the Arctic Ocean. The trajectory followed during the cruise is represented by the black lines between the cast positions. (b) Density profiles from the 2006 survey within the 300–700\\(\\mathrm{m}\\) depth range against distance traveled from the first cast. Profiles in blue correspond to the blue dots in (a). (c) Mean temperature and density profiles from mooring D averaged between September 2006 and August 2007 are shown with solid lines. The dashed lines show the same quantities but for a single cast in March 2007. (d) Time evolution of the density profiles at mooring D shown in panel (a). This figure is taken from (Menesguen et al. 2022).\n\n\nIn the lower atmosphere and most parts of the ocean, the density (or temperature) does not change significantly at different horizontal locations \\(\\xb=(x,y)\\) or in time. This motivates the Boussinesq approximation which involves writing the density (and pressure) as a sum of a base profile plus small perturbation, where the base profile only depends on \\(z\\). We will formulate this approximation mathematically in the next section, but before that it will be insightful to look at few observations of density and temperature variations in the ocean and atmosphere.\nFigure 2.2 shows a combination of two types of measurements in a region in the arctic ocean. In panel (a), there are four red dots that are mooring measurements obtained by a collection of devices connected to a wire and anchored on the sea floor. The other dots are measurements taken by a cruise that sends diving devices down into the ocean. The details of these observations are not important for us, but they show that several locations are sampled by different measuring devices and at different times. Panel (b) shows the density profiles of the cruise measurements at different locations. It is clear that the density profile has a (horizontal) mean that is a function of \\(z\\). The perturbations to this mean by changing the horizontal location are much smaller than the mean value itself. The variation of density from the base profile is better quantified in the panel (c). The solid black curve shows the mean (base) profile of the density next to a single cast with dashed black curve, which marginally deviates from the mean. Panel (d) shows the density profiles for a fixed location (location D in panel (a)), but at different times. It can be inferred from this plot that changing time does not affect the mean density profile very much. Looking at different part of the ocean, we get a more general base profile (a smoother mean). Nevertheless, the underlying message of this example still holds: the density is well approximated with a base profile that is a function of depth only plus small perturbations.\n\n\n\nFigure 2.3: An example of temperature-altitude profiles of the daily averaged temperature up to 40 km from 20 to 24 July 2009 over the Indian region (65\\(^{\\circ}\\)N–110\\(^{\\circ}\\)E). The figure is taken from (Prasad et al., 2018).\n\n\nFigure 2.3 displays the (daily) temperature profiles over a region in India. Atmospheric temperature is directly related to the density at each altitude (which has a fixed pressure). Hence, the relative magnitude of the mean temperature to perturbations can translate to the density as well. It is evident from this figure that changes in temperature at each altitude are relatively small for lower atmosphere (below 15km). There is a jump in temperature that is known as “tropopause”. Near the tropopause, the deviations from the mean temperature profile are larger, and the Boussinesq approximation is not justified.\nMeasurements similar to the examples just discussed are abundant in the literature thanks to several decades of observational campaigns. Considering them all together, we can conclude that in most parts of the ocean, and in the lower atmosphere, the variations in density at a fixed \\(z\\) are small relative to their means.\n\n\n2.2.2 Boussinesq approximation\nAs we have seen, the density in the ocean and in the lower layer of atmosphere varies by only a few percent across the depth or altitude. We can therefore exploit the smallness of these variations and write \\[\n\\rho(\\xb,t) = \\bar\\rho + \\delta\\rho(\\xb,t)\n\\] where \\(\\bar\\rho\\) is the average density (a constant) and \\(\\delta\\rho\\) are (small) perturbations away from this mean. The perturbations are assumed small so that \\(|\\delta\\rho|\\ll\\bar\\rho\\). Substituting this into the inviscid, incompressible momentum equation (i.e., Equation 1.7 with \\(\\nu=0\\)) and again assuming gravity is the only body force acting so that \\(\\fb_b=-g\\eb_z\\), we find \\[\n(\\bar\\rho + \\delta\\rho(\\xb,t)) \\frac{D\\ub}{Dt} = -\\nabla p - (\\bar\\rho + \\delta\\rho(\\xb,t))g\\eb_z.\n\\] Since \\(|\\delta\\rho|\\ll\\bar\\rho\\) we may be tempted to ignore all the terms involving \\(\\delta\\rho\\). Instead, we neglect all the terms involving \\(\\delta\\rho\\) except in the term involving gravity (here there is only one but in more complex cases there may be others). This is because while \\(|\\delta\\rho|\\ll\\bar\\rho\\), gravity is strong and so the buoyancy term (the one involving gravity) is retained. Making this approximation, known as the Boussinesq approximation, leads to \\[\n\\bar\\rho \\frac{D\\ub}{Dt} = -\\nabla p - (\\bar\\rho + \\delta\\rho(\\xb,t))g\\eb_z.\n\\] Then, dividing by \\(\\bar\\rho\\) and combining with equation (1.4) and (1.6), we obtain the so called Boussinesq equations: \\[\\frac{\\partial\\ub}{\\partial t} + (\\ub\\cdot\\nabla)\\ub = -\\frac{1}{\\bar\\rho}\\nabla p -\\frac{\\rho}{\\bar\\rho}g\\eb_z.  \\tag{2.6}\\] \\[ \\nabla\\cdot\\ub = 0,  \\tag{2.7}\\] \\[\\frac{D\\rho}{Dt}  = \\frac{\\partial \\rho}{\\partial t} + (\\ub\\cdot\\nabla)\\rho= 0,  \\tag{2.8}\\]\n\n\n\n\n\n\nAlthough we have derived this set of Boussinesq equations starting from the assumption of an incompressible fluid, it is possible to show that the Boussinesq approximation applies to a more general compressible fluid.\n\n\n\n\n\n\n\n\n\nThe Boussineq approximation is valid everywhere in the ocean since density variations are small. However, it is also valid for any motions in the atmosphere that are confined to a layer that is thin compared with the scale height of the atmosphere. For the Earth’s atmosphere, we have seen that the scale height is approximately \\(8\\)km and so the Boussinesq approximation should apply to motions that are confined to layers of about \\(1\\)km or less.\n\n\n\n\n\n2.2.3 Buoyancy as a variable\nNext, let’s consider splitting our variables into a reference state and perturbations to this state. We will consider a static, time-independent reference state with a vertical density stratification \\(\\rho=\\tilde\\rho(z)\\). Equation 2.7 and Equation 2.8 are automatically satisfied by this reference state and Equation 2.6 demands \\[\np=\\tilde p(z) \\quad \\text{with} \\quad \\frac{d\\tilde p}{dz} = -\\tilde\\rho g.\n\\tag{2.9}\\] Decomposing our variables in this way gives \\[\n\\ub = \\ub'(\\xb,t), \\quad \\rho = \\tilde\\rho(z) + \\rho'(\\xb,t), \\quad p = \\tilde p(z) + p'(\\xb,t)\n\\tag{2.10}\\] where a tilde denotes a reference state variable and the primed quantities are perturbations to these states (for now no assumptions are made about the size of the perturbations).\nNow, substituting (2.10) into Equation 2.6 gives \\[\n    \\frac{\\partial\\ub'}{\\partial t} + (\\ub'\\cdot\\nabla)\\ub' = -\\frac{1}{\\bar\\rho}\\nabla p' -\\frac{\\rho'}{\\bar\\rho}g\\eb_z = -\\frac{1}{\\bar\\rho}\\nabla p' +b\\eb_z,\n\\] where we have used Equation 2.9 to cancel reference state terms and introduced the buoyancy variable \\[ b = -\\frac{\\rho'}{\\bar\\rho} g .\n\\tag{2.11}\\] Note that this expression is analogous to the buoyancy force per unit mass \\(F_b/\\bar\\rho\\) introduced in Equation 2.1.\nSubstituting (2.10) into Equation 2.7 simply gives \\(\\nabla\\cdot\\ub'=0\\). Finally, substituting (2.10) into Equation 2.8 gives \\[\n\\frac{\\partial(\\tilde \\rho(z)+\\rho')}{\\partial t} + (\\ub'\\cdot\\nabla)(\\tilde\\rho(z)+\\rho')=0\\] \\[\\Rightarrow \\frac{\\partial\\rho'}{\\partial t} + (\\ub'\\cdot\\nabla)\\rho' + w'\\frac{d\\tilde\\rho}{dz}=0. \\tag{2.12}\\] Multiplying Equation 2.12 by \\(-\\frac{g}{\\bar\\rho}\\) allows us to form \\[\\begin{align*}\n\\frac{Db}{Dt}+\\left(\\frac{-g}{\\bar\\rho}\\frac{d\\tilde\\rho}{dz}\\right)w'&=0,\\\\\n\\Rightarrow\\frac{Db}{Dt}+N^2(z)w'&=0\n\\end{align*}\\] where \\[\nN^2(z) = -\\frac{g}{\\bar\\rho}\\frac{d\\tilde\\rho}{dz}.\n\\] Here \\(N(z)\\) is the buoyancy frequency in the Boussinesq approximation. Note it is subtly different to the definition in Equation 2.4.\nGathering together the Boussinesq equations for the perturbation quantities we have the following equation set:\n\n\n\n\n\n\n(Non-hydrostatic) Boussinesq Equations\n\n\n\n\\[ \\frac{\\partial\\ub}{\\partial t} + (\\ub\\cdot\\nabla)\\ub = -\\frac{1}{\\bar\\rho}\\nabla p +b\\eb_z,  \\tag{2.13}\\] \\[\\nabla\\cdot\\ub=0,   \\tag{2.14}\\] \\[\\frac{\\partial b}{\\partial t}+(\\ub\\cdot\\nabla)b+N^2(z)w=0, \\tag{2.15}\\]\n\n\nwhere we have dropped the primes from perturbation quantities as is customary.\n\n\n\n\n\n\nNote here that \\(p\\) is a perturbation to the background pressure state. In general, when \\(p\\) appears along side buoyancy in the governing equations then this indicates it is a perturbation pressure. This is in contrast to the Boussinesq equations where \\(p\\) in Equation 2.6 is taken to mean the full pressure (likewise in Equation 2.6, \\(\\rho\\) is the full density).\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nThe buoyancy (Brunt–Väisälä) frequency that appears in Equation 2.15 is an important quantity in different regimes of geophysical flows. Figure 2.4 shows the values of \\(N^2\\) for a region in the atmosphere/ocean as functions of altitude/depth. In the left plot, \\(N^2\\) over the region of Gadanki in India is shown. There is a noticeable jump at around 18km altitude (similar to what we observed in figure Figure 2.3, marking the “tropopause”, which is the border between two layers of atmosphere (troposphere and stratosphere). Note that the height of tropopause varies to some degrees in different locations (that is why the jump in Figure 2.3 and Figure 2.4 appears at slightly different altitudes). Around the tropopause, constant \\(N\\) or even the Boussinesq approximation are not valid, but in the lower atmosphere (below the tropopause) \\(N\\) can be assumed constant. Horizontal bars show standard deviations obtained while considering 43 different measurements during April 2006 to March 2007. The low variability in the lower atmosphere (relatively small bars) justifies the Boussinesq approximation, whereas the high variability near tropopause shows this approximation is no longer valid around this altitude.\nThe right plot is obtained from a mooring observation (“NISKINe” campaign). For the deep ocean (lower than 800 meters), it is safe to use constant \\(N\\). However, in the upper ocean the variation of \\(N\\) with depth cannot be neglected. A comparison between the two figures shows that \\(N\\) is an order of magnitude smaller in the ocean.\n\n\n\n\n\n\n\n\n\n\nFigure 2.4: Left: Stratification in the atmosphere in the region of Gadanki in India (13.5\\(^{\\circ}\\)N, 79.2\\(^{\\circ}\\)E). This curve is obtained by averaging over 43 radar measurements and the bars show the standard deviation for each altitude. This plot is taken from (Mehta et al., 2008). Right: raw stratification profile (blue) observed during a pilot cruise measurement campaign named ``NISKINe”, along with its 50-m moving average (black) and a Gaussian fit (orange). This plot is taken from (Asselin & Young, 2020).\n\n\n\n\n\n\n2.2.4 Hydrostatic approximation\nA common approximation in geophysical fluid dynamics is to assume that the horizontal scale is large compared to the vertical scale. In this case, the vertical component of the momentum equation is simply replaced by our hydrostatic balance equation. This is known as the hydrostatic approximation and leads to the following hydrostatic Boussinesq equations\n\n\n\n\n\n\n(Hydrostatic) Boussinesq Equations\n\n\n\n\\[ \\frac{\\partial \\vb}{\\partial t} + (\\ub\\cdot\\nabla)\\vb = -\\frac{1}{\\bar\\rho}\\nabla_H p, \\tag{2.16}\\] \\[   \\frac{\\partial p}{\\partial z}  = \\bar\\rho b = -\\rho g, \\tag{2.17}\\] \\[   \\nabla\\cdot \\ub =0, \\tag{2.18}\\] \\[    \\frac{\\partial b}{\\partial t} + (\\ub\\cdot\\nabla)b +N^2w =0, \\tag{2.19}\\]\n\n\nwhere \\(\\vb=(u,v)\\) is the horizontal velocity and \\(\\nabla_H=\\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\right)\\).\nNote that the hydrostatic approximation has resulted in the vertical momentum equation being replaced by hydrostatic balance.\n\n\n\n\n\n\nThe Boussinesq equations (2.13) - (2.15) (and their hydrostatic counterparts (2.16) - (2.19)) are the fundamental equations that are solved numerically in weather forecast and climate models. Because we observe and measure everything from the rotating Earth, these equations are solved in the rotating frame of reference (which we will come to in Chapter 4). Most climate models use the Hydrostatic equations as they require far fewer computational resources. Hence, because climate models (unlike weather models) are run for very long times (several years or decades), it is worth reducing the computational cost at the expense of making the hydrostatic assumption.\n\n\n\n\n\n\n\n\n\nIn the geophysical fluids literature, equations (2.16) - (2.19) are often known as the primitive equations. This is somewhat confusing as the non-Hydrostatic Boussinesq equation set is more general. However, the Hydrostatic Boussinesq equations are still more accurate than some other reduced equations such as the shallow water equations and quasigeostrophic equations that we will study in Chapters 3 and 5, respectively."
  },
  {
    "objectID": "shallow-water.html#overview",
    "href": "shallow-water.html#overview",
    "title": "3  Shallow Water Systems",
    "section": "3.1 Overview",
    "text": "3.1 Overview\nThe shallow water equations are a model of a thin layer of fluid with constant density which is bounded by a rigid surface from below and by a free surface from above. By ``thinness” – which is the most defining feature of these fluids – we mean the horizontal length scales of these flows are much larger than their vertical scales (and hence the name shallow!). Other characteristics of these equations which we will discuss in this section are the direct consequence of the thinness and constant density assumptions.\nThe shallow water equations are one of the simplest sets of PDEs describing geophysical fluids, yet they are very useful. They are used in practical models of shallow lakes, rivers and coastal flows. Due to their relative simplicity, many theoretical concepts in geophysical fluid dynamics are first investigated for shallow water systems before being studied in more complex systems. They also incorporate many phenomena that characterise atmospheric and oceanic flows such as geostrophic balance and waves (we will discuss these later in the course). The practical importance of shallow water equations aside, their derivation is a good example of using rigorous mathematical steps and physical assumptions to reduce the Boussinsq equations to a much simpler set."
  },
  {
    "objectID": "shallow-water.html#derivation",
    "href": "shallow-water.html#derivation",
    "title": "3  Shallow Water Systems",
    "section": "3.2 Derivation",
    "text": "3.2 Derivation\nWe use the defining characteristics of shallow water flows to derive their governing equations. Before that, let’s clarify the notation and conventions we are going to use (this is sometimes the most confusing part about shallow water systems because different sources in the literature adopt very different notation). We assume the \\(z\\) axis is perpendicular to the layer of water as shown in Figure 3.1. \\(z=0\\) can be placed at any arbitrary level (naturally we want to see it close the bottom surface). \\(\\eta(x,y,t)\\) is the vertical position of fluid surface measured from \\(z=0\\). Likewise, \\(\\eta_b(x,y,t)\\) is the vertical height of bottom topography measured from \\(z=0\\). \\(h(x,y,t)\\) is the thickness of water column measured from bottom boundary all the way to free surface, i.e. \\(h = \\eta - \\eta_b\\). The thinness of fluid has an important consequence: the vertical velocity (in the \\(z\\) direction) is much smaller than the horizontal velocity components (but is not necessarily zero). Hence, we only consider the two-dimensional horizontal velocity denoted by \\(\\vb =(u,v)\\) and assume \\(w \\ll u, v\\). Lastly, we denote the horizontal gradient operator by \\(\\gradH = (\\partial / \\partial x, \\partial / \\partial y)\\).\n\n\n\nFigure 3.1: A shallow water system. \\(h\\) is the thickness of a water column, \\(H\\) is the mean thickness, \\(\\eta\\) is the height of the free surface and \\(\\eta_b\\) is the height of the lower rigid. \\(\\Delta \\eta\\) is the deviation of free from average height.\n\n\n\n3.2.1 Momentum equations\nOne of the main consequences of small vertical velocity appears in the vertical momentum equation. Let’s consider the vertical momentum equation in the Boussinesq system (i.e., Equation 2.6) \\[ \\frac{\\partial w}{\\partial t} + (\\vb \\cdot\\gradH)w + w \\frac{\\partial w}{\\partial z} = -\\frac{1}{\\bar\\rho} \\frac{\\partial p}{\\partial z} -\\frac{\\rho}{\\bar\\rho}g.\n\\tag{3.1}\\] Assuming \\(w\\) to be smaller than the other variables, the vertical momentum equation then reduces to \\[\n    \\frac{\\partial p}{\\partial z} = - \\rho g,  \n\\] which is simply the hydrostatic balance that was discussed in Section 1.3 (cf. Equation 1.8). Because the density is assumed constant (\\(\\rho =\\bar\\rho= \\rho_0\\)), we may integrate this equation from \\(\\eta\\) to an arbitrary height \\(z\\) to give \\[ p(x,y,z,t) - p(x,y,\\eta(x,y,t),t) = \\rho_0 g (\\eta(x,y,t) - z).\n\\tag{3.2}\\] It is physically justified to assume the pressure at the free surface \\(p(x,y,\\eta,t)\\) is constant (for some applications we may need to change this assumption though). Hence, we can take the horizontal gradient of both sides of Equation 3.2 to arrive at \\[ \\gradH \\ p = \\rho_0 g \\ \\gradH \\ \\eta.\n\\tag{3.3}\\] Now we consider the horizontal momentum equation in Equation 2.6 and substitute for the horizontal pressure gradient using Equation 3.3 \\[ \\frac{\\partial \\vb}{\\partial t} + (\\vb \\cdot\\gradH) \\vb =  - g \\ \\gradH \\ \\eta,\n\\tag{3.4}\\] where we also neglected the vertical velocity at leading order. Note that the right-hand side of this equation is independent of \\(z\\). Hence, if we assume the velocity is initially independent of \\(z\\), it should remain independent of \\(z\\), i.e. \\(\\vb = \\vb(x,y,t)\\). As a consequence, for the rest of this chapter we do not deal with \\(z\\) derivative.\n\n\n3.2.2 Mass continuity equation\n\n\n\nFigure 3.2: A column of fluid in shallow water.\n\n\nConsider a (Cartesian) column of shallow water as shown in Figure 3.2. The height of this column \\(h\\) is measured from the bottom boundary to the free surface. The cross-sectional area of this column is \\(\\Dl x \\Dl y\\). If the fluid enters this column from the sides, its height has to increase to conserve mass (note that the density is constant and the fluid is incompressible). More quantitatively, let’s consider the two sides perpendicular to the \\(x\\)-axis. If the velocity normal to one of the sides is \\(u\\), the normal velocity to the other side will be \\(u + \\Dl x \\ {\\partial u} / {\\partial x}\\) (see Figure 3.2). Likewise, If the thickness of one side is \\(h\\), the thickness of the other side will be \\(h + \\Dl x \\ {\\partial h} / {\\partial x}\\). The mass flux through a side is calculated as the normal velocity times the surface area of the side times density. For example, if the normal velocity and vertical thickness are \\(u\\) and \\(h\\) respectively, the mass flux will be \\(\\rho_0 u h \\Dl y\\) (without loss of generality we assume the velocity \\(u\\) is pointing inward). Hence, the total amount of mass entering/leaving from these two sides is\n\\[\\begin{align*}\n\\text{MF}_x = \\text{mass flux along} &\\text{ the $x$ axis} = \\rho_0 u h \\Dl y - \\rho_0 \\left( u + \\Dl x \\ \\frac{\\partial u}{\\partial x} \\right)  \\left(h + \\Dl x \\ \\frac{\\partial h}{\\partial x} \\right) \\Dl y \\\\\n   &= -\\rho_0 \\Dl x \\ \\frac{\\partial u}{\\partial x}  h \\Dl y\n    -\\rho_0 u \\ \\Dl x \\  \\frac{\\partial h}{\\partial x}   \\Dl y  \n    -\\rho_0 \\Dl x \\ \\frac{\\partial u}{\\partial x} \\Dl x \\ \\frac{\\partial h}{\\partial x}  \\Dl y\n    \\end{align*}\\] Likewise, we obtain the total mass flux along the \\(y\\) axis \\[        \\text{MF}_y\n    = -\\rho_0 \\Dl y \\ \\frac{\\partial v}{\\partial y}  h \\Dl x\n    -\\rho_0 v \\ \\Dl y \\  \\frac{\\partial h}{\\partial y}   \\Dl x\n    -\\rho_0 \\Dl y \\ \\frac{\\partial v}{\\partial y} \\Dl y \\ \\frac{\\partial h}{\\partial y}  \\Dl x\n\\] The rate of change of mass in this fluid column is \\(\\rho_0 \\Dl x \\Dl y \\Dl h / \\Dl t\\) which should be equal to mass flux from the sides, i.e., \\[\n    \\rho_0 \\Dl x \\Dl y  \\frac{\\Dl h }{\\Dl t } =  \\text{MF}_x +  \\text{MF}_y.\n\\] After dividing this equation by \\(\\rho_0 \\Dl x \\Dl y\\) and taking the limit as \\(\\Dl x, \\Dl y, \\Dl t \\to 0\\), we find \\[\n    \\frac{\\partial h}{\\partial t} = - h \\left( \\frac{\\partial u}{\\partial x} +\\frac{\\partial v}{\\partial y} \\right) - u  \\frac{\\partial h}{\\partial x} - v  \\frac{\\partial h}{\\partial y}\n\\] which can be written as \\[\n    \\frac{\\partial h}{\\partial t} + \\gradH \\cdot (h \\vb)=0, \\quad \\text{or} \\quad  \\frac{D h}{D t} + h \\gradH \\cdot \\vb=0.\n\\tag{3.5}\\] Note that unlike Boussinesq or incompressible flows, the shallow water velocity is not divergence free. This is because the columns of fluids can be compressed by increasing their height.\n\n\n\n\n\n\nThe conservation of mass equation for the shallow water system can be derived from 3D mass conservation equation using \\(w \\ll u, v\\) (see the assignments).\n\n\n\nIn summary, in a non-rotating frame, the inviscid shallow water equations are\n\n\n\n\n\n\nInviscid Shallow Water Equations\n\n\n\n\\[ \\text{momentum:} \\quad \\frac{D \\vb}{D t}  =  - g \\ \\gradH \\eta.  \\tag{3.6}\\] \\[ \\text{mass continuity:} \\quad \\frac{\\partial h}{\\partial t} + \\gradH \\cdot (h \\vb) = 0, \\quad \\text{or} \\quad  \\frac{D h}{D t} + h \\gradH \\cdot \\vb=0  \\tag{3.7}\\] \\[ \\text{height relation:}  \\quad  h(x,y,t) = \\eta(x,y,t) - \\eta_b(x,y,t).  \\tag{3.8}\\]\n\n\n\n\n\n\n\n\nExample\n\n\n\n\n\n\nFigure 3.3: A schematic figure of dam break with two levels of water on each side.\n\n\nLet’s consider an example of a dam or membrane that creates two levels of fluid as shown in the figure Figure 3.3. The fluid is initially at rest and the bottom surface is assumed flat (i.e. \\(\\eta_b = \\text{constant}\\)). At \\(t=0\\), we remove the dam or membrane and want to see how this fluid behaves in time. This flow is one-dimensional so we can simply drop the dependence on \\(y\\) and set \\(v=0\\). Let’s say the difference between two levels is \\(2\\eta_0\\) (see the figure). We place \\(z=0\\) at half distance between the two levels such that \\[\n    \\eta(x,t=0) =\n\\begin{cases}\n+ \\eta_0,  \\quad x&lt;0  \\\\\n- \\eta_0,  \\quad x&gt;0  \n\\end{cases}\n= - \\eta_0 \\ \\mathrm{sgn}(x),\n\\tag{3.9}\\] where \\(\\mathrm{sgn}\\) is the sign function. Note that the fluid is initially at rest \\(u(x,t=0)=0\\). To analyse this problem we assume the disturbances to the initial state are relatively small and write \\[\n    h(x,t) = H + \\eta(x,t), \\quad u = u(x,t)\n\\]\nSubstituting these expressions into Equations (3.6)-(3.8) leads to \\[\\begin{align*}\n\\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} &= -g \\frac{\\partial \\eta}{\\partial x} \\\\\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( (H + \\eta)u \\right) &=   0 ,\n\\end{align*}\\] and further neglecting the product of (small) disturbance terms (i.e. \\(u\\) and \\(\\eta\\)) gives \\[\n    \\frac{\\partial u}{\\partial t}  + g \\frac{\\partial \\eta}{\\partial x} = 0  \\tag{3.10}\\] \\[ \\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial x}  =   0.  \\tag{3.11}\\] We can take the \\(x\\) derivative of Equation 3.10 and \\(t\\) derivative of Equation 3.11 and eliminate \\(u\\) to arrive at \\[\n    \\frac{\\partial^2 \\eta}{\\partial t^2} - c^2 \\frac{\\partial^2 \\eta}{\\partial x^2} = 0 , \\quad c = \\sqrt{g H},\n\\] which is simply the one-dimensional wave equation. For unbounded domains, you are familiar with the d’Alembert solution of the wave equation \\[\n    \\eta(x,t) = \\frac{1}{2} \\left( F(x-ct) + F(x+ct) \\right),\n\\tag{3.12}\\] where \\(F(x)\\) is the initial condition. Using the given initial condition for this problem (Equation 3.9), we find \\[\n    \\eta(x,t) = - \\frac{1}{2} \\eta_0 \\left( \\mathrm{sgn}(x-ct) + \\mathrm{sgn}(x+ct) \\right) =\n    \\begin{cases}\n+ \\eta_0  \\quad x&lt;-ct  \\\\\n       0 \\ \\   \\quad -ct&lt;x&lt;ct \\\\\n- \\eta_0  \\quad x&gt;ct  \n\\end{cases}\n\\] This solution implies that a half of the disturbance moves backwards and a half forwards, both with the speed \\(c=\\sqrt{g H}\\). In between the travelling disturbance becomes zero as shown in the left panel of Figure 3.4. It is interesting that the height disturbance travels faster if the water is deeper.\nWe can also derive the velocity for this solution by using Equation 3.12 and Equation 3.10 (or Equation 3.11) \\[\n    u(x,t) = - \\frac{1}{2} \\eta_0 \\sqrt{\\frac{g}{H}} \\left( \\mathrm{sgn}(x-ct) - \\mathrm{sgn}(x+ct) \\right) =\n    \\begin{cases}\n       0  \\ \\   \\quad  \\quad  \\quad \\quad  \\quad \\quad  x&lt;-ct  \\\\\n      {\\eta_0} \\sqrt{g/H}  \\quad -ct&lt;x&lt;ct \\\\\n       0  \\ \\   \\quad  \\quad  \\quad \\quad  \\quad \\quad x&gt;ct  \n\\end{cases}\n\\] As the disturbance moves to both sides, it creates a velocity in the middle (see the right panel of Figure 3.4). This velocity is larger in shallower water (proportional to \\(H^{-1/2}\\)).\n\n\n\nFigure 3.4: The height (top) and velocity (bottom) for the propagating height disturbance in shallow water system. The variables are normalised. The dashed line shows the initial condition and the solid line the solution at \\(t=4/c\\)."
  },
  {
    "objectID": "shallow-water.html#vortices-on-sloping-beaches",
    "href": "shallow-water.html#vortices-on-sloping-beaches",
    "title": "3  Shallow Water Systems",
    "section": "3.3 Vortices on sloping beaches",
    "text": "3.3 Vortices on sloping beaches\nThere are cases where the changes in \\(\\eta\\) are small compared to the flow and bottom surface, but the surface pressure is no longer constant. In such cases, we need to modify the shallow water equations by changing the top boundary condition from constant pressure to constant \\(\\eta\\). This boundary condition is known as a rigid lid as it is literally the equivalent of putting a rigid lid on the top. Using this condition, Equation 3.2 changes to \\[    p(x,y,z,t) - p(x,y,0,t) = \\rho_0 g (0 - z), \\] where we place our \\(z\\) axis at the top surface that is nearly constant. Taking the horizontal gradient of this equation gives, \\[  \\gradH \\ p(x,y,z,t)  = \\gradH \\ (p_0(x,y,t) =p(x,y,0,t)), \\] where we used \\(p_0\\) to denote the surface pressure. Note the constant \\(\\eta\\) assumption means that \\(h(x,y,t) = - \\eta_b(x,y)\\). As a result, if the bottom surface doesn’t change with time (reasonable assumption for many problems with a solid boundary), \\(\\partial h /\\partial t =0\\). Using these assumptions, we can write the rigid-lid shallow water equations as \\[ \\frac{D \\vb}{D t}  =  - \\frac{1}{\\rho_0}\\ \\gradH p_0,  \\tag{3.13}\\] \\[ \\gradH \\cdot (h \\vb) = 0,  \\tag{3.14}\\] \\[ h(x,y,t) = \\eta_b(x,y,t). \\tag{3.15}\\]\n\n\n\n\n\n\nThe rigid-lid shallow water system is a good approximation for flows on sloping beaches as surface variations compared to the changes of the bottom slope and velocities are negligible. This is also a good model for lab experiments where the flow is confined by a solid wall from the top.\n\n\n\nWe can transform equations (3.13)-(3.15) into the following equation (see the assignment for derivation) \\[q = \\frac{\\nabla \\times \\vb}{h} = \\frac{\\partial v/\\partial x - \\partial u/\\partial y}{h}, \\quad  \\frac{D q}{D t} = 0.  \\tag{3.16}\\]\nThis shows that the quantity \\(q\\) is conserved materially (i.e. on particle trajectories), which has important consequences for the dynamics. For example, if a vortex is pushed up toward shallower parts of a sloping beach, it becomes stronger and rotates faster.\n\n\n\n\n\n\n\\(q\\) as defined in Equation 3.16 is a special case of a quantity known as Potential Vorticity (PV). We will introduce the general form of this quantity in chapter 5 and show that is it conserved for some limits of the shallow water and Boussinesq equations. Such a conservation law is an important element of large-scale atmospheric and oceanic flows."
  },
  {
    "objectID": "rotation.html#rotating-reference-frame",
    "href": "rotation.html#rotating-reference-frame",
    "title": "4  Rotating fluids",
    "section": "4.1 Rotating reference frame",
    "text": "4.1 Rotating reference frame\nConsider an inertial frame of reference \\(\\mathrm{I}\\), described by orthogonal basis vectors \\(\\eb_1\\), \\(\\eb_2\\) and \\(\\eb_3\\) and a second frame of reference \\(\\mathrm{R}\\) described by orthogonal basis vectors \\(\\hat\\eb_1\\), \\(\\hat\\eb_2\\) and \\(\\hat\\eb_3\\) which is rotating with angular velocity \\(\\Omb\\) relative to \\(\\mathrm{I}\\). If we define \\(\\left(\\ddt{}\\right)_\\mathrm{I}\\) to be a derivative with respective to time in the inertial frame, then clearly we have that \\(\\left(\\ddt{\\eb_j}\\right)_\\mathrm{I}=0\\) but \\(\\left(\\ddt{\\hat\\eb_j}\\right)_\\mathrm{I}\\neq0\\) because \\(\\hat\\eb_j\\) is rotating relative to our inertial frame.\nNow, consider a vector \\(\\Cb\\) of constant length that is rotating relative to the inertial frame at a constant angular velocity \\(\\Omb\\). It follows that, in the rotating frame \\(R\\), \\(\\Cb\\) appears stationary, i.e., \\(\\left(\\ddt{\\Cb}\\right)_\\mathrm{R}=0\\) where now \\(\\left(\\ddt{}\\right)_\\mathrm{R}\\) is a derivative taken in the rotating frame of reference. We want to know how this vector appear to change in time if observed from the inertial frame, i.e., what is \\(\\left(\\ddt{\\Cb}\\right)_\\mathrm{I}\\)?\nConsider a small interval of time \\(\\delta t\\) over which \\(\\Cb\\) rotates through a small angle \\(\\delta \\lambda\\) (see Figure 4.1). Then, the change in \\(\\Cb\\) as observed in the inertial frame is \\[ \\delta\\Cb = |\\Cb|\\sin\\gamma\\delta\\lambda \\eb_n \\] where \\(\\gamma\\) is the angle between \\(\\Omb\\) and \\(\\Cb\\), and \\(\\hat n\\) is the unit vector in the direction of the change of \\(\\Cb\\) (perpendicular to both \\(\\Omb\\) and \\(\\Cb\\)). But the change in \\(\\lambda\\) is easily obtained from the angular velocity, in particular we have \\(\\delta \\lambda = |\\Omb|\\delta t\\) and hence \\[ \\delta \\Cb = |\\Cb||\\Omb|\\sin\\gamma\\delta t \\eb_n = \\Omb \\times \\Cb \\delta t. \\] It follows that \\[ \\left( \\ddt{\\Cb}\\right)_\\mathrm{I} = \\Omb\\times\\Cb.  \\tag{4.1}\\]\n\n\n\nFigure 4.1: A vector \\(\\Cb\\) rotating relative to the inertial frame at a constant angular velocity \\(\\Omb\\). Over a small interval of time \\(\\delta t\\), \\(\\Cb\\) rotates through a small angle \\(\\delta \\lambda\\). \\(\\gamma\\) is the angle between \\(\\Omb\\) and \\(\\Cb\\), and \\(\\eb_n\\) is the unit vector in the direction of the change of \\(\\Cb\\) (perpendicular to both \\(\\Omb\\) and \\(\\Cb\\)). Figure adapted from Vallis.\n\n\n\n\n\n\n\n\nExample\n\n\n\nConsider the case where the rotating frame is rotating about the \\(\\eb_3\\) axis at a constant rate \\(\\mathrm{\\Omega}\\). In this case basis vectors for the inertial frame and the rotating frame are related by \\[\\begin{align*}\n\\hat\\eb_1 &= \\cos(\\Omrm t)\\eb_1 + \\sin(\\Omrm t)\\eb_2, \\quad \\hat\\eb_2 = -\\sin(\\Omrm t)\\eb_1 + \\cos(\\Omrm t)\\eb_2, \\quad \\hat\\eb_3 = \\eb_3,\\\\\n\\eb_1 &= \\cos(\\Omrm t)\\hat\\eb_1 - \\sin(\\Omrm t)\\hat\\eb_2, \\quad \\eb_2 = \\sin(\\Omrm t)\\hat\\eb_1 + \\cos(\\Omrm t)\\hat\\eb_2, \\quad\\quad \\eb_3 = \\hat\\eb_3.\n\\end{align*}\\] Now, any vector \\(\\ab\\) can be expressed as \\[\\begin{align*}\n\\ab = a_j\\eb_j &= a_1(\\cos(\\Omrm t)\\hat\\eb_1 - \\sin(\\Omrm t)\\hat\\eb_2) + a_2(\\sin(\\Omrm t)\\hat\\eb_1 + \\cos(\\Omrm t)\\hat\\eb_2) + a_3\\hat\\eb_3\\\\\n& = (a_1\\cos(\\Omrm t) + a_2\\sin(\\Omrm t))\\hat \\eb_1 + (-a_1\\sin(\\Omrm t) + a_2\\cos(\\Omrm t))\\hat \\eb_2 + a_3\\hat\\eb_3 = \\hat a_j \\hat\\eb_j,\n\\end{align*}\\] where \\(\\hat a_1 = a_1\\cos(\\Omrm t) + a_2\\sin(\\Omrm t)\\), \\(\\hat a_2 = -a_1\\sin(\\Omrm t) + a_2\\cos(\\Omrm t)\\) and \\(\\hat a_3=a_3\\). Note the coordinates \\(a_j\\) and \\(\\hat a_j\\) are different but vector is the same.\nWe see that even simple trajectories can appear non-trivial in a rotating frame, e.g.,\n\nA stationary particle with position \\(\\ab=(a_0,0,0)\\) corresponds to \\(\\hat\\ab=(a_0\\cos(\\Omrm t), -a_0\\sin(\\Omrm t),0)\\) in the rotating frame. This is a clockwise rotation with angular velocity \\(\\Omrm\\).\nA particle moving in a straight line at speed \\(v\\) with position \\(\\ab=(vt,0,0)\\) in the inertial frame corresponds to \\(\\hat\\ab=(vt\\cos(\\Omrm t), -vt\\sin(\\Omrm t),0)\\) in the rotating frame. This corresponds to a clockwise spiral.\n\nNote that \\[\\begin{align*}\n\\left(\\ddt{\\hat\\eb_1} \\right)_\\mathrm{I} &= \\ddt{}(\\cos(\\Omrm t)\\eb_1 + \\sin(\\Omrm t)\\eb_2) = -\\Omrm\\sin(\\Omrm t)\\eb_1 + \\Omrm\\cos(\\Omrm t)\\eb_2 = \\Omrm\\hat\\eb_2\\\\\n\\left(\\ddt{\\hat\\eb_2} \\right)_\\mathrm{I} &= \\ddt{}(-\\sin(\\Omrm t)\\eb_1 + \\cos(\\Omrm t)\\eb_2) = -\\Omrm\\cos(\\Omrm t)\\eb_1 - \\Omrm\\sin(\\Omrm t)\\eb_2 = -\\Omrm\\hat\\eb_1\\\\\n\\left(\\ddt{\\hat\\eb_3} \\right)_\\mathrm{I} &= 0.\n\\end{align*}\\] Combining together, we can write \\[ \\left( \\ddt{\\hat\\eb_j}\\right)_\\mathrm{I} = \\Omb\\times\\hat\\eb_j \\] which is expected from Equation 4.1.\n\n\nNow let’s consider a general vector \\(\\Bb(t)=B_j(t){\\hat\\eb}_j\\). In the rotating frame we have that \\[ \\left( \\ddt{\\Bb}\\right)_\\mathrm{R} = \\ddt{}(B_j{\\hat\\eb}_j)_\\mathrm{R} = \\ddt{B_j}{\\hat\\eb}_j \\] since the \\({\\hat\\eb}_j\\) are stationary in the rotating frame. Note, there is no need to state which reference frame we differentiate the \\(B_j\\) in since they are scalar functions.\nIn the inertial frame we have \\[\\begin{align*}\n\\left( \\ddt{\\Bb}\\right)_\\mathrm{I} = \\ddt{}(B_j{\\hat\\eb}_j)_\\mathrm{I} &=  \\ddt{B_j}{\\hat\\eb}_j + B_j\\left(\\ddt{\\hat\\eb_j}\\right)_\\mathrm{I}\\\\\n& =  \\left(\\ddt{\\Bb}\\right)_\\mathrm{R} + B_j\\Omb\\times\\hat{\\eb}_j\\\\\n& =  \\left(\\ddt{\\Bb}\\right)_\\mathrm{R} + \\Omb\\times(B_j\\hat{\\eb}_j)\\\\\n& =  \\left(\\ddt{\\Bb}\\right)_\\mathrm{R}  + \\Omb\\times\\Bb.\n\\end{align*}\\] So, for any vector \\(\\Bb\\), we have \\[\\left( \\ddt{\\Bb}\\right)_\\mathrm{I} =  \\left(\\ddt{\\Bb}\\right)_\\mathrm{R}  + \\Omb\\times\\Bb.  \\tag{4.2}\\]"
  },
  {
    "objectID": "rotation.html#dynamics-in-a-rotating-frame",
    "href": "rotation.html#dynamics-in-a-rotating-frame",
    "title": "4  Rotating fluids",
    "section": "4.2 Dynamics in a rotating frame",
    "text": "4.2 Dynamics in a rotating frame\nIf we take \\(\\Bb=\\Xb\\) in Equation 4.2 to be the position vector of a fluid parcel, then we have that \\[ \\ub_\\mathrm{I} = \\ub_\\mathrm{R} +  \\Omb\\times\\Xb \\] where \\(\\ub_\\mathrm{I}\\) is the perceived velocity in the inertial frame, and \\(\\ub_\\mathrm{R}\\) is the perceived velocity in the rotating frame.\nThen, to consider how accelerations are viewed in a rotating frame, put \\(\\Bb=\\ub_\\mathrm{I}\\) in Equation 4.2: \\[\\begin{align*}\n\\left( \\ddt{\\ub}\\right)_\\mathrm{I} & =  \\left(\\ddt{\\ub}\\right)_\\mathrm{R}  + \\Omb\\times\\ub_\\mathrm{I}\\\\\n& = \\left(\\ddt{}(\\ub_\\mathrm{R}+  \\Omb\\times\\Xb)\\right)_\\mathrm{R} + \\Omb\\times(\\ub_\\mathrm{R}+  \\Omb\\times\\Xb)\\\\\n& = \\left(\\ddt{\\ub}\\right)_\\mathrm{R}+  \\Omb\\times\\left(\\ddt{\\Xb}\\right)_\\mathrm{R} + \\Omb\\times\\ub_\\mathrm{R}+ \\Omb\\times(\\Omb\\times\\Xb)\\\\\n& = \\left(\\ddt{\\ub}\\right)_\\mathrm{R}+  2\\Omb\\times\\ub_\\mathrm{R} + \\Omb\\times(\\Omb\\times\\Xb).\n\\end{align*}\\] In an inertial frame Newton’s law gives (for a fluid parcel of mass \\(m\\)) \\[\n\\left( \\ddt{\\ub}\\right)_\\mathrm{I} = \\frac{1}{m}\\Fb,\n\\] so when viewed in a rotating frame, the same parcel obeys \\[\n\\left( \\ddt{\\ub}\\right)_\\mathrm{R} = \\frac{1}{m}\\Fb - 2\\Omb\\times\\ub_\\mathrm{R} - \\Omb\\times(\\Omb\\times\\Xb).\n\\]\nThe extra “force” terms that appear on the right-hand-side are a result of working in a non-inertial reference frame. Since the forces are not real, they are often referred to as fictitious or apparent forces. The second term on the right-hand-side is known as the Coriolis force. If \\(\\Omb\\) points up (down), the Coriolis force deflects horizontally moving objects to the right (left) when observed in a rotating frame of reference.\nThe third term on the right-hand-side is known as the Centrifugal force. This force appears to push objects away from the rotation axis.\nNow that we can treat accelerations appropriately, we can write down the momentum equation in a rotating frame of reference. We just need to replace \\(\\DDt{\\ub_\\mathrm{I}}\\) with \\[\n\\DDt{\\ub_\\mathrm{R}} + 2\\Omb \\times\\ub_\\mathrm{R} + \\Omb\\times(\\Omb \\times \\Xb).\n\\tag{4.3}\\] For example, in the case of the Boussinesq equations, the momentum equation (2.6) becomes \\[\n\\DDt{\\ub_\\mathrm{R}}  +2\\Omb\\times\\ub_\\mathrm{R} +\\Omb\\times(\\Omb \\times \\Xb) = -\\frac{1}{\\bar\\rho}\\nabla p +b\\eb_z.\n\\]\nAs density (or buoyancy) is a scalar, Equation 2.15 is unchanged in a rotating frame and therefore the Boussinesq equations in a rotating frame can be summarised as:\n\\[ \\DDt{\\ub}  + 2\\Omb\\times\\ub +\\Omb\\times(\\Omb \\times \\Xb) = -\\frac{1}{\\bar\\rho}\\nabla p +b\\eb_z,  \\tag{4.4}\\] \\[  \\nabla\\cdot\\ub = 0, \\tag{4.5}\\] \\[ \\DDt{b} +N^2(z)w=0, \\tag{4.6}\\] where we have dropped the subscript \\(\\mathrm{R}\\) from the velocity as we simply interpret \\(\\ub\\) in these equations to be the velocity in a rotating frame of reference.\n\n\n\n\n\n\nHere we have allowed for the effects of rotation by writing the (non-hydrostatic) Boussinesq momentum equation in a rotating reference frame. Note that other equation sets (e.g., the the shallow water, incompressible Navier-Stokes and hydrostatic Boussinesq equations) can be written in a rotating frame of reference in a similar way, i.e., by using Equation 4.3 to incorporate the Coriolis and centrifugal forces in the momentum equations. We will make use of this in future sections.\n\n\n\n\n4.2.1 Centrifugal force as a potential\nA simplification to these equations can be made if we are able to write the centrifugal force as the gradient of a scalar potential that can then be combined with the pressure. To do this, we define a set of cylindrical polar coordinates \\((s,\\theta,z)\\) in which the \\(z\\)-axis is aligned with the rotation axis, i.e., with \\(\\Omb\\). \\(s\\) is then the perpendicular distance from the \\(z\\)-axis. Since in cylindrical polars, the position vector is given by \\(\\Xb = s\\eb_s+z\\eb_z\\) we have that \\[\n\\Omb\\times(\\Omb\\times\\Xb) = \\Omrm\\eb_z \\times \\Omrm s \\eb_\\theta = -\\Omrm^2 s \\eb_s,\n\\] demonstrating that the centrifugal force \\(-\\Omb\\times(\\Omb\\times\\Xb)\\) pushes objects away from the rotation axis. Now, we want to find a potential \\(\\phi_c\\) such that \\(\\nabla \\phi_c = \\Omb\\times(\\Omb\\times\\Xb)\\). It follows that \\[\n\\frac{\\partial \\phi_c}{\\partial s} = -\\Omrm^2s, \\quad \\quad \\frac{\\partial \\phi_c}{\\partial \\theta} = \\frac{\\partial \\phi_c}{\\partial z} = 0,\n\\] and hence \\(\\phi_c = -\\frac{\\Omrm^2s^2}{2} = -\\frac{1}{2}|\\Omb \\times \\Xb|^2\\).\nWriting the centrifugal force as \\(-\\Omb\\times(\\Omb\\times\\Xb) = -\\nabla \\phi_c\\) allows us to simplify Equation 4.4 to give \\[  \\DDt{\\ub}  +2\\Omb\\times\\ub  = -\\frac{1}{\\bar\\rho}\\nabla p_r -\\frac{\\rho}{\\bar\\rho}g\\eb_z, \\tag{4.7}\\] where \\(p_r = p + \\bar\\rho\\phi_c\\).\n\n\n\n\n\n\nTo simplify the notation we drop the subscript \\(r\\) in the rest of this course, while we consider the modified pressure that includes the centrifugal effect.\n\n\n\n\n\n\n\n\n\nSimilar to centrifugal force, gravity can be formulated as a potential \\(\\phi_g\\) such that \\(\\gb=-\\nabla \\phi_g\\). Taking the Earth to be a perfect sphere of radius \\(r_e = 6371\\mathrm{km}\\) and mass \\(M=5.98\\times10^{24}\\mathrm{kg}\\), Newton’s law of gravitation gives \\(\\phi_g = -GM/r\\) where \\(G=6.67\\times10^{-11}\\mathrm{m^3kg^{-1}s^{-2}}\\) is the gravitational constant. Then \\(\\gb=\\nabla(GM/r)=-(GmM/r^2)\\eb_r\\) (points radially inwards). At the Earth’s surface \\(|\\gb|=GM/r_e^2=9.82\\mathrm{ms^{-2}}\\). If the height (depth) changes are small enough, we can assume that \\(\\gb\\) is locally constant, which is what we consider for the rest of this course. However, if in an application dynamics takes place in a thick layer of fluid, the variation of \\(\\gb\\) should be properly taken into account."
  },
  {
    "objectID": "rotation.html#sec-tang_plane_approx",
    "href": "rotation.html#sec-tang_plane_approx",
    "title": "4  Rotating fluids",
    "section": "4.3 Tangent-plane approximation",
    "text": "4.3 Tangent-plane approximation\nTo study the fluid dynamics of oceans and atmospheres, it is convenient to work in a frame of reference rotating with the planet. In this course, our model planet will be the Earth. The spherical geometry of Earth can influence the dynamics of flows and make studying them more involved. However, the sphericity of the Earth is not always as important as its rotation. In this case, it is more convenient to use a locally Cartesian model and introduce two approximations.\nIn spherical polar coordinates \\((r,\\theta,\\phi)\\) where \\(r\\) is a radial coordinate, \\(\\theta\\) is the latitude (angle measured northwards from the equator) and \\(\\phi\\) is the longitutde we have that \\[\\begin{equation}\n\\Omb = \\Omrm\\sin\\theta\\eb_r + \\Omrm\\cos\\theta \\eb_\\theta.\n\\end{equation}\\] That is, \\(\\Omb\\) in its most general form has a radially (locally vertical) and a meridional (locally horizontal) component which both depend on latitude \\(\\theta\\). However, if we limit the dynamics to a region where the changes in \\(\\theta\\) are small, we can make a set of simplifications. We define a plane tangent to the surface of the Earth at a latitude \\(\\theta_0\\) and use a Cartesian system to define the motion (see figure \\(\\ref{fig:Tangent_plane}\\)). We take the \\(z\\)-axis to point in the direction of \\(-\\nabla\\Phi\\) and write \\(-\\nabla\\Phi=g\\eb_z\\) where \\(g\\) is taken to be constant over the depth of the (thin) layer. \\(x\\) is taken to point eastwards and \\(y\\) northwards. We define \\(y=0\\) at \\(\\theta=\\theta_0\\).\n\n\n\nFigure 4.2: Tangent plane approximation.\n\n\nSince the geopotential force is directed almost radially inwards, we take \\(\\eb_r\\approx\\eb_z\\) and \\(\\eb_\\theta\\approx\\eb_y\\) at \\(\\theta=\\theta_0\\) and we make the approximation \\[\n\\Omb=\\Omrm\\sin\\theta\\eb_r+\\Omrm\\cos\\theta\\eb_\\theta \\approx \\Omrm\\sin\\theta\\eb_z+\\Omrm\\cos\\theta\\eb_y.\n\\] For small \\(\\theta-\\theta_0\\), \\(y\\approx r_e(\\theta-\\theta_0)\\) and so we have that \\[\\begin{align*}\n\\sin\\theta&=\\sin(\\theta+(\\theta-\\theta_0)) =\\sin\\theta_0 + (\\theta-\\theta_0)\\cos\\theta_0 + O((\\theta-\\theta_0)^2) \\approx \\sin\\theta_0 +\\frac{\\cos\\theta_0}{r_e}y\\\\\n\\cos\\theta&=\\cos(\\theta+(\\theta-\\theta_0)) = \\cos\\theta_0 - (\\theta-\\theta_0)\\sin\\theta_0 + O((\\theta-\\theta_0)^2) \\approx \\cos\\theta_0 -\\frac{\\sin\\theta_0}{r_e}y.\n\\end{align*}\\] Hence we write \\(\\Omb = \\Omrm_z\\eb_z + \\Omrm_y\\eb_y\\) where \\[\\begin{align*}\n\\Omrm_z&=\\Omrm\\sin\\theta_0+\\frac{\\Omrm\\cos\\theta_0}{r_e}y\\\\\n\\Omrm_y&=\\Omrm\\cos\\theta_0-\\frac{\\Omrm\\sin\\theta_0}{r_e}y.\n\\end{align*}\\]\nThe Coriolis force \\(2\\Omb\\times \\ub\\) can then be written as \\[\n2\\Omb\\times \\ub = (2\\Omrm_y w - 2\\Omrm_z v, 2\\Omrm_z u, -2\\Omrm_y u)\n\\] Hence the Cartesian components of momentum equations under the tangent plane approximation are: \\[ \\DDt{u} + 2(\\Omrm_yw-\\Omrm_zv) = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}  \\tag{4.8}\\] \\[ \\DDt{v} + 2\\Omrm_z u = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y}  \\tag{4.9}\\] \\[\\DDt{w}  -2\\Omrm_y u = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} -g.  \\tag{4.10}\\]\nIf we further assume that the layer is thin then the vertical flow speed is much smaller than the horizontal flow speeds, i.e., \\(|w| \\ll |u| \\text{ and } |v|\\). We can therefore drop the \\(\\Omrm_y w\\) term in Equation 4.8. Then, to ensure energy is still conserved we must then also drop the \\(-\\Omrm_y u\\) term from Equation 4.10 although in someways this is less physically justified. This leads to the following set of equations: \\[\\begin{align}\n\\DDt{u} -fv &= -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} \\\\\n\\DDt{v} + fu &= -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y} \\\\\n\\DDt{w}   &= -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} -g,\n\\end{align}\\] where we have introduced \\(f=2\\Omrm_z\\). Equivalently, these equations can be written in vector form as \\[\n\\DDt{\\ub} + \\fb\\times\\ub = -\\frac{1}{\\rho}\\nabla p -g\\eb_z,\n\\tag{4.11}\\] where \\(\\fb=f(y)\\eb_z\\). This formulation in which components of \\(\\Omb\\) not in the direction of the local vertical is sometimes called the traditional approximation. Note, the centrifugal potential no longer appears in our equations, this is a result of defining the local vertical in the direction of \\(-\\nabla\\Phi\\). Therefore, rotation enters the equations only through the Coriolis force and \\(f\\) is often called the Coriolis parameter.\n\\(f\\) is an important parameter in rotating fluid dynamics and it is often written as \\[\nf = f_0 + \\beta y, \\quad\\quad \\text{where } f_0= 2\\Omrm\\sin\\theta_0, \\quad \\beta = \\frac{2\\Omrm\\cos\\theta_0}{r_e}.\n\\] Note that \\(f_0\\) is positive in the northern hemisphere (\\(\\theta_0&gt;0\\)), negative in the southern hemisphere (\\(\\theta_0&lt;0\\)), and zero at the equator (\\(\\theta_0=0\\)). Representing \\(f\\) in this way is the basis of the so-called \\(\\beta\\)-plane approximation, with the \\(\\beta\\) term containing the latitudinal variations in \\(f\\).\nIf the flows we care about are extremely localised then we do not need to take the latitudinal variations in \\(f\\) into account and we can make a further approximation given by \\(f=f_0=2\\Omrm\\sin\\theta_0\\). This is known as the \\(f\\)-plane approximation. Note, under the \\(f\\)-plane approximation (i.e., with \\(f\\) constant), Equation 4.11 is analogous to that used in sections 4.4.1 - 4.4.3 where we took \\(\\Omb = \\Omrm\\eb_z\\) (provided we replace \\(2\\Omrm\\) by \\(f_0\\)) and so physical concepts such as geostrophic balance, Taylor-Proudman, and thermal wind balance are relevant on the \\(f\\)-plane too.\nConsidering the tangent plane approximation \\(2\\Omb \\approx \\fb=f \\eb_z\\), we rewrite the important equations in geophysical fluid dynamics (Boussinesq and Shallow Water) that we focus on in this course in the rotating frame of reference.\n\n\n\n\n\n\nInviscid Shallow Water Equations\n\n\n\n\\[  \\frac{\\partial \\vb}{\\partial t} + (\\vb\\cdot\\nabla)\\vb   + \\fb\\times\\vb =  - g \\ \\gradH \\eta.  \\tag{4.12}\\] \\[ \\frac{\\partial h}{\\partial t} + \\gradH \\cdot (h \\vb) = 0,   \\tag{4.13}\\] \\[  h(x,y,t) = \\eta(x,y,t) - \\eta_b(x,y,t).  \\tag{4.14}\\]\n\n\n\n\n\n\n\n\n(Hydrostatic) Boussinesq Equations\n\n\n\n\\[   \\frac{\\partial \\vb}{\\partial t} + (\\ub\\cdot\\nabla)\\vb  + \\fb\\times\\vb = -\\frac{1}{\\bar\\rho}\\gradH p, \\tag{4.15}\\] \\[   \\frac{\\partial p}{\\partial z}  = \\bar\\rho b = -\\rho g, \\tag{4.16}\\] \\[   \\nabla\\cdot \\ub =0, \\tag{4.17}\\] \\[    \\frac{\\partial b}{\\partial t} + (\\ub\\cdot\\nabla)b +N^2w =0, \\tag{4.18}\\]\n\n\n\n\n\n\n\n\nRotating (Non-hydrostatic) Boussinesq Equations\n\n\n\n\\[ \\frac{\\partial\\ub}{\\partial t} + (\\ub\\cdot\\nabla)\\ub + \\fb\\times\\ub = -\\frac{1}{\\bar\\rho}\\nabla p +b\\eb_z,  \\tag{4.19}\\] \\[\\nabla\\cdot\\ub=0,   \\tag{4.20}\\] \\[\\frac{\\partial b}{\\partial t}+(\\ub\\cdot\\nabla)b+N^2(z)w=0, \\tag{4.21}\\]"
  },
  {
    "objectID": "rotation.html#rotationally-dominated-flow",
    "href": "rotation.html#rotationally-dominated-flow",
    "title": "4  Rotating fluids",
    "section": "4.4 Rotationally dominated flow",
    "text": "4.4 Rotationally dominated flow\n\n4.4.1 Geostrophic balance\nIn some fluid flows (e.g. large-scale dynamics in the atmosphere and ocean), the Coriolis force and pressure gradients appear to be much larger than the other forces or acceleration terms. As a result, the horizontal components of Equation 4.19 (or Equation 4.15) reduce to\n\\[\n\\fb\\times\\ub = -\\frac{1}{\\bar\\rho}\\gradH p.\n\\tag{4.22}\\] This equation represents an important balance in geophysical fluid dynamics and is known as geostrophic balance. It follows from Equation 4.22 that \\(\\ub\\cdot\\nabla p=0\\) for the horizontal components of velocity. Then, since surfaces of constant pressure have normal \\(\\nabla p\\), horizontal wind flows along lines of constant pressure.\n\n\n\n\n\n\nWe will put the concept of geophysical balance on firmer mathematical footing in chapter 5.\n\n\n\n\n\n\n\n\n\nExample\n\n\n\nConsider a region of atmosphere rotating about a vertical axis (\\(\\Omb = \\Omrm \\eb_z\\)) which is at higher pressure than in surrounding regions (sometimes called a high pressure centre) so that the negative pressure gradient \\(-\\nabla p\\) is pointing away from the centre of the region. The gas will want to move from high pressure to low pressure but the gas will be pushed to the right by the Coriolis force so that it moves in a clockwise (or anticyclonic) motion around the high pressure centre. In the southern hemisphere anticyclones are still associated with regions of high pressure but in that case the motion will be anti-clockwise.\n\n\n\n\n4.4.2 Taylor-Proudman theorem\nIf in the vertical direction we assume hydrostatic balance (as when making the hydrostatic approximation in Section 2.2.4) so that we have \\[\n\\frac{\\partial p}{\\partial z} = -\\rho g,\n\\tag{4.23}\\] and if we consider the case where density is a function of \\(z\\) only and the background rotation is aligned with gravity, i.e., \\(\\Omb=\\Omrm \\eb_z\\), then geostrophic balance in the horizontal direction gives us (see Equation 4.22) \\[\n-f v = -\\frac{1}{\\bar\\rho}\\frac{\\partial p}{\\partial x}, \\quad \\quad f u = -\\frac{1}{\\bar\\rho}\\frac{\\partial p}{\\partial y}.\n\\tag{4.24}\\] These equations can be rearranged to give \\[\nv = \\frac{\\partial}{\\partial x}\\frac{p}{f\\bar\\rho}, \\quad \\quad u = -\\frac{\\partial}{\\partial y}\\frac{p}{f\\bar\\rho}.\n\\tag{4.25}\\] It follows form here that \\(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0\\) and so it must be that \\(\\frac{\\partial w}{\\partial z}=0\\) (from Equation 4.5). In other words, the vertical velocity is independent of height.\nNow, since \\(\\rho=\\rho(z)\\), Equation 4.23 gives \\(\\frac{\\partial^2 p}{\\partial x\\partial z} = \\frac{\\partial^2 p}{\\partial y\\partial z}=0\\) and so Equation 4.25 then gives us that \\(\\frac{\\partial u}{\\partial z}=\\frac{\\partial v}{\\partial z}=0\\) (recall \\(\\bar\\rho\\) is a constant). Therefore we have that the horizontal flow is also independent of height.\nWe have shown what is commonly known as the Taylor-Proudman theorem which says within a fluid that is steadily rotated at high angular velocity, the fluid velocity will be uniform along any line parallel to the axis of rotation. For example, if there is a solid horizontal boundary, at the surface, say, then \\(w=0\\) at that boundary and so (since vertical derivatives are zero) \\(w=0\\) everywhere. Hence the flow is essentially two-dimensional.\n\n\n\n\n\n\nIn reality, we do not see exact two-dimensional flow in the atmosphere of the oceans (essentially because of stratification). However, it is not uncommon in geophysical fluid dynamics for effects like Taylor-Proudman to manifest in the real flow, even if assumptions underlying a phenomena are not fully satisfied.\n\n\n\n\n\n\n\n\n\nExample\n\n\n\n\n\n\nFigure 4.3: Taylor-Proudman column\n\n\nIf rotating fluid moves around an obstacle near the ground, the fluid must also move around an ‘imaginary’ obstacle higher up in the fluid. This is depicted in @fig–taylorproudman and can be observed in rotating tank experiments such as this video.\n\n\n\n\n4.4.3 Thermal wind balance\nBy combining geostrophic and hydrostatic approximations, we arrive at another important balance in geophysical fluid dynamics, so called thermal wind balance. To see the balance we simply differentiate the horizontal geostrophic balance equations (4.24) by \\(z\\): \\[\nf\\frac{\\partial v}{\\partial z} = \\frac{1}{\\bar\\rho}\\frac{\\partial^2 p}{\\partial z \\partial x}, \\quad\\quad f\\frac{\\partial u}{\\partial z} = -\\frac{1}{\\bar\\rho}\\frac{\\partial^2 p}{\\partial z \\partial y},\n\\] and combine these with hydrostatic balance from the hydrostatic Boussinesq equations (4.16) to give \\[ f\\frac{\\partial v}{\\partial z} = \\frac{\\partial b}{\\partial x}  \\tag{4.26}\\] \\[ f\\frac{\\partial u}{\\partial z} = -\\frac{\\partial b}{\\partial y}.  \\tag{4.27}\\] These equations represent thermal wind balance and the vertical derivative of the geostrophic velocity (wind) is known as the thermal wind. If the buoyancy is constant (e.g., if the density is constant) then there is no shearing of the geostrophic wind and equations (4.26) - (4.27) reduce to the Taylor-Proudman constraint."
  }
]